This code is written based on tylertreat (https://github.com/tylertreat). 
